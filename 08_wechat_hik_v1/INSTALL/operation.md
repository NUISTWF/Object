<!--
 * @Author: hik_wangfei105
 * @Date: 2024-07-10 21:01:51
 * @FilePath: \wechat\INSTALL\operation
 * @Description: wechat项目的操作文档
-->

# 操作说明：

1. 在项目的根目录下，即wechat目录下，直接执行 `make` 命令即可完成所有文件的编译。

2. 项目目录结构如下：
   - `src`：源码目录，包含服务器的源码。
     - `server`：服务器的源码目录。
       - 执行 `./server` 可启动服务器。注意，每次启动服务器后，需要手动删除 `wechat.db` 数据库文件，因为每次启动服务器时，都会重新创建数据库，如果不删除，会导致数据库创建失败，程序运行失败。
   - `client`：客户端的源码目录。
     - 执行 `./client` 可启动客户端。

3. 客户端初始运行界面：
   - 输入 `1`（register）：进入注册界面，输入用户名和密码进行注册。如果用户名已被注册，则注册失败。
   - 输入 `2`（login）：进入登录界面，输入用户名和密码进行登录验证。验证通过后，登录成功。
   - 输入 `3`（quit）：直接退出客户端。
   - 输入 `4`（logout）：注销当前用户，输入用户名和密码进行验证。验证通过后，注销账户，并清除该账户相关的所有信息。

4. 登录后的界面：
   - 输入 `1`（add friend）：添加好友，输入好友的用户名进行验证。如果用户不存在，则重新输入。
   - 输入 `2`（query friendlist）：查看好友列表，列出当前用户的好友。
   - 输入 `3`（delete friend）：删除好友，输入好友的用户名。如果没有该好友，则删除失败。
   - 输入 `4`（choose friend send msg）：选择好友进行聊天，输入好友的用户名，进入聊天界面。可以查看好友是否在线（online/offline），选择发送消息或文件。选择 `1`（msg）发送消息，选择 `2`（file）发送文件。当前目录下提供了两个文件（txt文件和c文件）供测试发送文件（文件输入时请输入全称包括后缀）。如果对方离线，也可以发送消息，对方下次登录后会收到消息。
   - 输入 `5`（query friend chat record）：查看与好友的聊天记录，输入好友的用户名。如果没有该好友，则查询失败。有该好友时，会显示互相之间的收发消息和发送时间，按顺序展示。
   - 输入 `6`（delete friend chat record）：删除与好友的聊天记录，输入好友的用户名。如果没有该好友，则删除失败。删除与该好友的所有信息，包括聊天记录等。此时也可以查看好友列表，好友列表也会一并删除。
   - 输入 `7`（quit）：退出客户端界面。

5. 额外说明：
   - 用户在给在线好友发送消息时（也可以给离线用户发信息，即对方没登录），如果对方突然下线，下一次对方上线后也会立即收到。当所有客户端都退出后，服务器不退出的情况下，任意客户可支持任何时间的重新登录，只要用户名和密码正确即可登录，并且可以继续进行上述操作。

6. 注意事项：
   - 在运行服务器之前，需要先安装 `sqlite3`，因为服务器需要使用 `sqlite3` 数据库来存储数据。